<div class="dashboard-container">
  <header>
    
    <!-- <a routerLink="/" >Spendwise</a> -->
    <h1><a routerLink="/" >Spendwise</a></h1>
    <nav>
      <span class="nav-username" *ngIf="user">Hello, {{ user.username }}!</span>
      <a routerLink="/profile" class="nav-link">Profile</a>
      <a routerLink="/spend-ratio" class="nav-link">Spend Ratios</a>
      <button class="action-btn logout-btn" (click)="logout()" title="Logout">
        <!-- <i class="fas fa-sign-out-alt"></i> -->
         logout
      </button>
    </nav>
  </header>
  <div class="content-wrapper">
    <aside class="sidebar">
      <div class="card form-card">
        <h3>{{ editingExpense ? 'Edit Expense' : 'Add Expense' }}</h3>
        <form (ngSubmit)="editingExpense ? updateExpense() : addExpense()" #expenseForm="ngForm">
          <!-- <div class="form-group">
            <label for="type">Type</label>
            <select id="type" [(ngModel)]="formExpense.type" name="type" required>
              <option value="Income">Income</option>
              <option value="Expense">Expense</option>
            </select>
          </div> -->
          <div class="form-group" *ngIf="formExpense.type === 'Expense'">
            <label for="category">Category</label>
            <select id="category" [(ngModel)]="formExpense.category" name="category" required>
              <option *ngFor="let category of categories" [value]="category" [disabled]="category === 'All'">
                {{ category }}
              </option>
            </select>
          </div>
          <div class="form-group">
            <label for="amount">Amount</label>
            <input type="number" id="amount" [(ngModel)]="formExpense.amount" name="amount" required min="0" placeholder="â‚¹0.00" />
          </div>
          <div class="form-group">
            <label for="date">Date</label>
            <input type="date" id="date" [(ngModel)]="formExpense.date" name="date" required />
          </div>
          <div class="form-group">
            <label for="description">Description</label>
            <input type="text" id="description" [(ngModel)]="formExpense.description" name="description" required placeholder="Enter description" />
          </div>
          <div class="form-actions">
            <button type="submit" class="action-btn submit-btn" [disabled]="!expenseForm.valid" [title]="editingExpense ? 'Update' : 'Add'">
              <!-- <i [ngClass]="editingExpense ? 'fas fa-check' : 'fas fa-plus'"></i> -->
              {{ editingExpense ? 'Update' : 'Add' }}

            </button>
            <button *ngIf="editingExpense" type="button" class="action-btn cancel-btn" (click)="cancelEdit()" title="Cancel">
              <!-- <i class="fas fa-times"></i> -->
               cancel
            </button>
          </div>
        </form>
      </div>
    </aside>
    <main class="main-content">
      <h2>Your Expenses</h2>
      <div *ngIf="error" class="error">{{ error }}</div>
      <div class="card">
        <h3>Dashboard Overview</h3>
        <p class="overview-text">Track your spending effortlessly.</p>
        <div class="stat-grid">
          <div class="stat-card">
            <p class="stat-label">Total Expenses</p>
            <p class="stat-value">{{ getTotalExpenses() | currency:'INR' }}</p>
          </div>
          <div class="stat-card">
            <p class="stat-label">Number of Expenses</p>
            <p class="stat-value">{{ expenses.length }}</p>
          </div>
        </div>
      </div>
      <div class="card">
        <h3>Expense History</h3>
        <div class="filter-group" *ngIf="formExpense.type === 'Expense'">
          <label for="filterCategory">Filter by Category</label>
          <select id="filterCategory" [(ngModel)]="selectedCategory" (ngModelChange)="filterExpenses()">
            <option *ngFor="let category of categories" [value]="category">
              {{ category }}
            </option>
          </select>
        </div>
        <div class="expense-list">
          <table *ngIf="expenses.length; else noExpenses">
            <thead>
              <tr>
                <th>Type</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Description</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let expense of expenses">
                <td>{{ expense.type }}</td>
                <td>{{ expense.category }}</td>
                <td>{{ expense.amount | currency:'INR' }}</td>
                <td>{{ expense.description }}</td>
                <td>{{ expense.date | date:'d MMMM y' }}</td>
                <td>
                  <button class="action-btn edit-btn" (click)="editExpense(expense)" title="Edit">
                    <!-- <i class="fas fa-edit"></i> -->
                     Edit
                  </button>
                  <button class="action-btn delete-btn" (click)="deleteExpense(expense._id)" title="Delete">
                    <!-- <i class="fas fa-trash"></i> -->
                     delete
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <ng-template #noExpenses>
            <p class="no-data">No expenses found. Add one above!</p>
          </ng-template>
        </div>
        <div class="download-buttons">
          <!-- <label >Filter by Category</label> -->
          <h2>download reports</h2>

          <button class="action-btn pdf-btn" (click)="downloadPDF()" title="Download PDF">
            <!-- <i class="fas fa-file-pdf"></i> -->
             pdf
          </button>
          <button class="action-btn excel-btn" (click)="downloadExcel()" title="Download Excel">
            <!-- <i class="fas fa-file-excel"></i> -->
             excel
          </button>
        </div>
      </div>
    </main>
  </div>
</div>